import{R as e,d as l,X as a,u as t,Y as o,c as u,e as n,Z as s,O as d,w as r,k as i,f as p,F as c,z as m,N as v,G as f,V as _,o as h,j as b,y,U as V,E as j,m as I,P as g,I as x,$ as k,J as C,D as U}from"./index-7ed7b84e.js";/* empty css                *//* empty css              *//* empty css                     *//* empty css                 *//* empty css                     *//* empty css                *//* empty css               *//* empty css            *//* empty css                  *//* empty css               */import{r as w}from"./request-e26a986b.js";import{e as E}from"./teachingServ-91173710.js";const $=async l=>(await e("/api/innovation/list",{studentId:l})).data,P={class:"base_form"},R={class:"base_query_oneLine"},A={class:"query_left"},D={key:0,class:"query_right"},L={class:"table_center",style:{"margin-top":"5px"}},N={style:{display:"flex","justify-content":"center","margin-top":"10px"}},O=l({__name:"InnovationTable",setup(e){const l=a(!1),O=a([]),q=a(""),B=a([]),M=a({id:0,student:{studentId:"",person:{personId:"",num:""}},socialPractice:"",competition:"",technology:"",lecture:"",project:"",internship:""}),G=()=>{M.value={id:0,student:{studentId:"",person:{personId:"",num:""}},socialPractice:"",competition:"",technology:"",lecture:"",project:"",internship:""}},H=t(),T=()=>{$().then((e=>{B.value=e;H.$state.userInfo.roles}))},z=a(!1),F=()=>{var e;J(M.value.student.studentId)?(e=M.value,w({url:"/api/innovation",method:"post",data:e})).then((e=>{l.value=!1,T()})):V.error({message:"该学生已存在"}),G(),z.value=!1},J=async e=>{let l=!1;const a=await $(e);return 1===a.length&&(M.value=a[0],l=!0),a.length>1&&(l=!1),a&&0!==a.length||(G(),M.value.student.studentId=e,l=!0),l},K=e=>{(e=>w({url:`/api/innovation/${e}`,method:"delete"}))(e).then((e=>{T()}))};return o((()=>{(async()=>{E().then((e=>{O.value=e}))})(),T()})),(e,a)=>{const t=m,o=j,V=I,w=g,E=v,T=x,S=k,X=C,Y=f,Z=U,Q=_;return h(),u(c,null,[n("div",P,[a[17]||(a[17]=n("div",{class:"base_header"},[n("div",{class:"blue_column"}),n("div",{class:"base_title"},"创新实践管理")],-1)),n("div",R,[n("div",A,[s(H).$state.userInfo.roles.includes("ROLE_ADMIN")?(h(),d(t,{key:0,class:"commButton",type:"primary",onClick:a[0]||(a[0]=e=>(l.value=!0,G(),void(z.value=!1)))},{default:r((()=>a[13]||(a[13]=[b("添加")]))),_:1})):i("",!0)]),s(H).$state.userInfo.roles.includes("ROLE_ADMIN")||s(H).$state.userInfo.roles.includes("ROLE_TEACHER")?(h(),u("div",D,[p(E,{inline:!0},{default:r((()=>[p(w,{label:"学生"},{default:r((()=>[p(V,{modelValue:q.value,"onUpdate:modelValue":a[1]||(a[1]=e=>q.value=e)},{default:r((()=>[(h(!0),u(c,null,y(O.value,(e=>(h(),d(o,{label:e.title,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(w,null,{default:r((()=>[p(t,{type:"default",class:"commButton",onClick:a[2]||(a[2]=e=>{$(q.value).then((e=>{B.value=e}))})},{default:r((()=>a[14]||(a[14]=[b("查询")]))),_:1})])),_:1})])),_:1})])):i("",!0)]),n("div",L,[p(Y,{data:B.value},{default:r((()=>[p(T,{label:"id",prop:"id"}),p(T,{label:"学生",prop:"student.numName"}),p(T,{label:"社会实践",prop:"socialPractice"}),p(T,{label:"学科竞赛",prop:"competition"}),p(T,{label:"科技成果",prop:"technology"}),p(T,{label:"培训讲座",prop:"lecture"}),p(T,{label:"创新项目",prop:"project"}),p(T,{label:"校外实习",prop:"internship"}),s(H).$state.userInfo.roles.includes("ROLE_ADMIN")?(h(),d(T,{key:0,label:"操作"},{default:r((e=>[p(X,null,{default:r((()=>[p(t,{onClick:a=>{return t=e.row,M.value=t,z.value=!0,void(l.value=!0);var t},type:"success"},{default:r((()=>a[15]||(a[15]=[b("编辑")]))),_:2},1032,["onClick"]),p(S,{title:"确定要删除吗?",onConfirm:l=>K(e.row.id)},{reference:r((()=>[p(t,{type:"danger"},{default:r((()=>a[16]||(a[16]=[b("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})):i("",!0)])),_:1},8,["data"])])]),p(Q,{id:"favDialog",modelValue:l.value,"onUpdate:modelValue":a[12]||(a[12]=e=>l.value=e),width:"400px"},{header:r((()=>a[18]||(a[18]=[n("h1",null,"荣誉添加修改对话框",-1)]))),default:r((()=>[p(E,{"label-width":"80px",model:M.value,ref:"form"},{default:r((()=>[p(w,{label:"学生"},{default:r((()=>[p(V,{disabled:z.value,modelValue:M.value.student.studentId,"onUpdate:modelValue":a[3]||(a[3]=e=>M.value.student.studentId=e),placeholder:"请选择...",onChange:a[4]||(a[4]=e=>J(M.value.student.studentId))},{default:r((()=>[(h(!0),u(c,null,y(O.value,(e=>(h(),d(o,{label:e.title,value:e.id},null,8,["label","value"])))),256))])),_:1},8,["disabled","modelValue"])])),_:1}),p(w,{label:"社会实践"},{default:r((()=>[p(Z,{modelValue:M.value.socialPractice,"onUpdate:modelValue":a[5]||(a[5]=e=>M.value.socialPractice=e),type:"textarea",placeholder:"社会实践"},null,8,["modelValue"])])),_:1}),p(w,{label:"学科竞赛"},{default:r((()=>[p(Z,{modelValue:M.value.competition,"onUpdate:modelValue":a[6]||(a[6]=e=>M.value.competition=e),type:"textarea",placeholder:"学科竞赛"},null,8,["modelValue"])])),_:1}),p(w,{label:"科技成果"},{default:r((()=>[p(Z,{modelValue:M.value.technology,"onUpdate:modelValue":a[7]||(a[7]=e=>M.value.technology=e),type:"textarea",placeholder:"科技成果"},null,8,["modelValue"])])),_:1}),p(w,{label:"培训讲座"},{default:r((()=>[p(Z,{modelValue:M.value.lecture,"onUpdate:modelValue":a[8]||(a[8]=e=>M.value.lecture=e),type:"textarea",placeholder:"培训讲座"},null,8,["modelValue"])])),_:1}),p(w,{label:"创新项目"},{default:r((()=>[p(Z,{modelValue:M.value.project,"onUpdate:modelValue":a[9]||(a[9]=e=>M.value.project=e),type:"textarea",placeholder:"创新项目"},null,8,["modelValue"])])),_:1}),p(w,{label:"校外实习"},{default:r((()=>[p(Z,{modelValue:M.value.internship,"onUpdate:modelValue":a[10]||(a[10]=e=>M.value.internship=e),type:"textarea",placeholder:"校外实习"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),n("div",N,[p(t,{type:"primary",onClick:F},{default:r((()=>a[19]||(a[19]=[b("确认")]))),_:1}),p(t,{onClick:a[11]||(a[11]=e=>l.value=!1)},{default:r((()=>a[20]||(a[20]=[b("取消")]))),_:1})])])),_:1},8,["modelValue"])],64)}}});export{O as default};
