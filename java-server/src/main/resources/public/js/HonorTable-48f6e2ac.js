import{R as e,d as a,X as l,u as t,Y as d,c as o,e as u,Z as s,O as r,w as n,k as i,f as m,F as p,z as c,N as v,G as f,V as _,o as b,j as h,y,M as V,E as I,m as j,P as g,I as w,$ as k,J as D,D as x,Q as C}from"./index-ebbc268c.js";/* empty css                *//* empty css                    *//* empty css              *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                     *//* empty css                *//* empty css            *//* empty css                  *//* empty css               */import{r as T}from"./request-c45980cc.js";import{e as Y}from"./teachingServ-68e3f6d8.js";const E=async a=>(await e("/api/honor/list",{studentId:a})).data,M={class:"base_form"},N={class:"base_query_oneLine"},U={class:"query_left"},R={key:0,class:"query_right"},$={class:"table_center",style:{"margin-top":"5px"}},A={style:{display:"flex","justify-content":"center","margin-top":"10px"}},L=a({__name:"HonorTable",setup(e){const a=l(!1),L=l([]),O=l(""),q=l([]),B=l({honorId:0,name:"",description:"",student:{studentId:"",person:{personId:0,num:"",name:"",type:"",dept:"",card:"",gender:"",birthday:"",email:"",phone:"",address:"",introduce:""},major:"",className:""},getTime:"",reward:""}),H=()=>{B.value={honorId:0,name:"",description:"",student:{studentId:"",person:{personId:0,num:"",name:"",type:"",dept:"",card:"",gender:"",birthday:"",email:"",phone:"",address:"",introduce:""},major:"",className:""},getTime:"",reward:""}},F=()=>{E().then((e=>{q.value=e}))},G=()=>{const e=new Date;var l;new Date(B.value.getTime)>e?V.alert("获奖时间不能大于当天日期"):""!=B.value.name&&""!=B.value.description&&""!=B.value.student.studentId&&""!=B.value.getTime&&""!=B.value.reward?((l=B.value,T({url:"/api/honor",method:"post",data:l})).then((e=>{a.value=!1,F()})),H()):V.alert("请填写完整信息")},z=e=>{(e=>T({url:`/api/honor/${e}`,method:"delete"}))(e).then((e=>{F()}))},J=t();return d((()=>{(async()=>{Y().then((e=>{L.value=e}))})(),F()})),(e,l)=>{const t=c,d=I,V=j,T=g,Y=v,F=w,K=k,P=D,Q=f,S=x,X=C,Z=_;return b(),o(p,null,[u("div",M,[l[14]||(l[14]=u("div",{class:"base_header"},[u("div",{class:"blue_column"}),u("div",{class:"base_title"},"荣誉管理")],-1)),u("div",N,[u("div",U,[s(J).$state.userInfo.roles.includes("ROLE_ADMIN")?(b(),r(t,{key:0,class:"commButton",type:"primary",onClick:l[0]||(l[0]=e=>(a.value=!0,void H()))},{default:n((()=>l[10]||(l[10]=[h("添加")]))),_:1})):i("",!0)]),s(J).$state.userInfo.roles.includes("ROLE_ADMIN")||s(J).$state.userInfo.roles.includes("ROLE_TEACHER")?(b(),o("div",R,[m(Y,{inline:!0},{default:n((()=>[m(T,{label:"学生"},{default:n((()=>[m(V,{modelValue:O.value,"onUpdate:modelValue":l[1]||(l[1]=e=>O.value=e)},{default:n((()=>[(b(!0),o(p,null,y(L.value,(e=>(b(),r(d,{label:e.title,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(T,null,{default:n((()=>[m(t,{type:"default",class:"commButton",onClick:l[2]||(l[2]=e=>{E(O.value).then((e=>{q.value=e}))})},{default:n((()=>l[11]||(l[11]=[h("查询")]))),_:1})])),_:1})])),_:1})])):i("",!0)]),u("div",$,[m(Q,{data:q.value},{default:n((()=>[m(F,{label:"id",prop:"honorId"}),m(F,{label:"名称",prop:"name"}),m(F,{label:"描述",prop:"description"}),m(F,{label:"获奖学生",prop:"student.numName"}),m(F,{label:"获取时间",prop:"getTime"}),m(F,{label:"奖励",prop:"reward"}),s(J).$state.userInfo.roles.includes("ROLE_ADMIN")?(b(),r(F,{key:0,label:"操作"},{default:n((e=>[m(P,null,{default:n((()=>[m(t,{onClick:l=>{return t=e.row,B.value=t,void(a.value=!0);var t},type:"success"},{default:n((()=>l[12]||(l[12]=[h("编辑")]))),_:2},1032,["onClick"]),m(K,{title:"确定要删除吗?",onConfirm:a=>z(e.row.honorId)},{reference:n((()=>[m(t,{type:"danger"},{default:n((()=>l[13]||(l[13]=[h("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})):i("",!0)])),_:1},8,["data"])])]),m(Z,{id:"favDialog",modelValue:a.value,"onUpdate:modelValue":l[9]||(l[9]=e=>a.value=e),width:"400px"},{header:n((()=>l[15]||(l[15]=[u("h1",null,"荣誉添加修改对话框",-1)]))),default:n((()=>[m(Y,{"label-width":"80px",model:B.value,ref:"form"},{default:n((()=>[m(T,{label:"名称"},{default:n((()=>[m(S,{modelValue:B.value.name,"onUpdate:modelValue":l[3]||(l[3]=e=>B.value.name=e),placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),m(T,{label:"描述"},{default:n((()=>[m(S,{modelValue:B.value.description,"onUpdate:modelValue":l[4]||(l[4]=e=>B.value.description=e),placeholder:"请输入描述",type:"textarea"},null,8,["modelValue"])])),_:1}),m(T,{label:"获奖学生"},{default:n((()=>[m(V,{modelValue:B.value.student.studentId,"onUpdate:modelValue":l[5]||(l[5]=e=>B.value.student.studentId=e),placeholder:"请选择..."},{default:n((()=>[(b(!0),o(p,null,y(L.value,(e=>(b(),r(d,{label:e.title,value:e.id},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),m(T,{label:"获奖时间"},{default:n((()=>[m(X,{modelValue:B.value.getTime,"onUpdate:modelValue":l[6]||(l[6]=e=>B.value.getTime=e),type:"date",placeholder:"选择日期",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),m(T,{label:"奖励"},{default:n((()=>[m(S,{modelValue:B.value.reward,"onUpdate:modelValue":l[7]||(l[7]=e=>B.value.reward=e),placeholder:"请输入奖励",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),u("div",A,[m(t,{type:"primary",onClick:G},{default:n((()=>l[16]||(l[16]=[h("确认")]))),_:1}),m(t,{onClick:l[8]||(l[8]=e=>a.value=!1)},{default:n((()=>l[17]||(l[17]=[h("取消")]))),_:1})])])),_:1},8,["modelValue"])],64)}}});export{L as default};
