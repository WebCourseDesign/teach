import{d as e,M as t,_ as a,c as l,e as s,j as o,f as r,w as i,F as d,N as u,z as m,G as n,V as c,o as h,y as f,O as p,W as b,P as g,D as y,I as V,J as _,E as v,m as C}from"./index-7ed7b84e.js";/* empty css                *//* empty css            *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                     *//* empty css              *//* empty css               *//* empty css                  */import{a as x,c as I,b as S,g as w}from"./teachingServ-91173710.js";import{m as j,a as L}from"./messageBox-cbe65a59.js";import{c as k,g as q}from"./changeCourseServ-6910b402.js";import{l as U}from"./lodash-7eb39dc3.js";import"./request-e26a986b.js";const N=e({data:()=>({numName:"",courseList:[],courseSelectList:[],deleteId:-1,form:{},dialogVisible:!1,isSelect:0,teacherList:[],tempCourse:{}}),created(){this.query(),this.getState(),this.getTeachers()},methods:{refresh(){this.query(),this.getState(),this.getTeachers()},makeSelectCourseList(){this.courseSelectList=[];for(let e=0;e<this.courseList.length;e++){const t=this.courseList[e];this.courseSelectList.push({id:t.courseId,value:t.num,title:t.num+"-"+t.name})}},async query(){this.courseList=await x(this.numName),this.makeSelectCourseList()},addItem(){this.form={teacher:{teacherId:""}},this.dialogVisible=!0},editItem(e){e.teacher||(e.teacher={teacherId:""}),this.form=U.cloneDeep(e),null!=e.preCourse&&(this.form.preCourseId=e.preCourse.courseId),this.dialogVisible=!0},close(){this.dialogVisible=!1},async confirm(){if(!/^sdu\d{4}$/.test(this.form.num))return void t.alert("课程号格式不正确,请以sdu开头加4位数字");if(!this.form.name)return void t.alert("课程名不能为空");if(!this.form.maxCount||!/^\d{1,3}$/.test(this.form.maxCount.toString()))return void t.alert("课容量格式不正确,只能为1-3位整数");if(this.form.maxCount<10)return void t.alert("课容量小于10,无法开课");if(!this.form.credit||!/^([1-9]?\d|100)(\.\d{1})?$/.test(this.form.credit.toString()))return void t.alert("学分格式不正确,只能为一位小数或两位数以内的整数");if(""==this.form.teacher.teacherId)return void t.alert("请选择教师");this.close();const e=await I(this.form);0==e.data.code?(j(this,"保存成功"),this.query()):t.alert(e.data.msg),this.refresh()},async deleteItem(e){if(!(await L("确认删除吗?")))return;const a=await S(e);0==a.code?(j(this,"删除成功"),this.query()):t.alert(a.msg)},submitChange(){k().then((e=>{this.isSelect=e.data.data,this.getState()}))},getState(){q().then((e=>{this.isSelect=e.data.data}))},getTeachers(){w().then((e=>{this.teacherList=e.data.data}))}}}),B={class:"base_form"},P={class:"base_header"},T={class:"base_title"},$={class:"base_query_oneLine"},D={class:"query_left"},E={class:"query_right"},G={class:"query_input"},J={class:"table_center",style:{"margin-top":"5px"}},z={style:{display:"flex","justify-content":"center","margin-top":"10px"}};const A=a(N,[["render",function(e,t,a,x,I,S){const w=b,j=g,L=u,k=m,q=y,U=V,N=_,A=n,F=v,H=C,M=c;return h(),l(d,null,[s("div",B,[s("div",P,[t[14]||(t[14]=s("div",{class:"blue_column"},null,-1)),s("div",T,[t[13]||(t[13]=o("课程管理 ")),r(L,null,{default:i((()=>[r(j,{label:"·是否选课"},{default:i((()=>[r(w,{"active-text":"开始选课","inactive-text":"停止选课","active-value":1,"inactive-value":0,modelValue:e.isSelect,"onUpdate:modelValue":t[0]||(t[0]=t=>e.isSelect=t),onChange:e.submitChange},null,8,["modelValue","onChange"])])),_:1})])),_:1})])]),s("div",$,[s("div",D,[r(k,{class:"commButton",type:"primary",onClick:t[1]||(t[1]=t=>e.addItem())},{default:i((()=>t[15]||(t[15]=[o("添加")]))),_:1})]),s("div",E,[r(L,null,{default:i((()=>[r(j,{label:"课程号或课程名"},{default:i((()=>[s("div",G,[r(q,{modelValue:e.numName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.numName=t)},null,8,["modelValue"]),r(k,{class:"subButton",type:"default",onClick:t[3]||(t[3]=t=>e.query())},{default:i((()=>t[16]||(t[16]=[o("查询")]))),_:1})])])),_:1})])),_:1})])]),t[19]||(t[19]=s("div",{style:{color:"#930e14","text-align":"center","font-weight":"bold"}}," ps：课序号格式只能为“sduxxxx”，其中x为整数 ",-1)),s("div",J,[r(A,{data:e.courseList,style:{width:"100%"},"label-width":"80px"},{default:i((()=>[r(U,{prop:"num",label:"课程号"}),r(U,{prop:"name",label:"课程名"}),r(U,{prop:"credit",label:"学分"}),r(U,{prop:"coursePath",label:"教材"}),r(U,{prop:"teacher.person.name",label:"教师"}),r(U,{prop:"preCourse.name",label:"前序课"}),r(U,{prop:"maxCount",label:"课容量"}),r(U,{label:"操作"},{default:i((a=>[r(N,null,{default:i((()=>[r(k,{type:"success",onClick:t=>e.editItem(a.row)},{default:i((()=>t[17]||(t[17]=[o("编辑")]))),_:2},1032,["onClick"]),r(k,{type:"danger",onClick:t=>e.deleteItem(a.row.courseId)},{default:i((()=>t[18]||(t[18]=[o("删除")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])]),r(M,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[12]||(t[12]=t=>e.dialogVisible=t),width:"300px"},{header:i((()=>t[20]||(t[20]=[s("h1",null,"课程添加修改对话框",-1)]))),default:i((()=>[r(L,{model:e.form,"label-width":"80px"},{default:i((()=>[r(j,{label:"课程号"},{default:i((()=>[r(q,{modelValue:e.form.num,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.num=t),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),r(j,{label:"课程名"},{default:i((()=>[r(q,{modelValue:e.form.name,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.name=t),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),r(j,{label:"学分"},{default:i((()=>[r(q,{modelValue:e.form.credit,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.credit=t),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),r(j,{label:"教材"},{default:i((()=>[r(q,{modelValue:e.form.coursePath,"onUpdate:modelValue":t[7]||(t[7]=t=>e.form.coursePath=t),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),r(j,{label:"课容量"},{default:i((()=>[r(q,{modelValue:e.form.maxCount,"onUpdate:modelValue":t[8]||(t[8]=t=>e.form.maxCount=t),style:{width:"100%"},type:"number"},null,8,["modelValue"])])),_:1}),r(j,{label:"教师"},{default:i((()=>[r(H,{modelValue:e.form.teacher.teacherId,"onUpdate:modelValue":t[9]||(t[9]=t=>e.form.teacher.teacherId=t)},{default:i((()=>[(h(!0),l(d,null,f(e.teacherList,(e=>(h(),p(F,{key:e.teacherId,label:e.person.name,value:e.teacherId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(j,{label:"前序课"},{default:i((()=>[r(H,{modelValue:e.form.preCourseId,"onUpdate:modelValue":t[10]||(t[10]=t=>e.form.preCourseId=t),placeholder:"请选择..."},{default:i((()=>[(h(!0),l(d,null,f(e.courseSelectList,(e=>(h(),p(F,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s("div",z,[r(k,{type:"primary",onClick:e.confirm},{default:i((()=>t[21]||(t[21]=[o("确认")]))),_:1},8,["onClick"]),r(k,{onClick:t[11]||(t[11]=t=>e.dialogVisible=!1),style:{"margin-right":"30px"}},{default:i((()=>t[22]||(t[22]=[o("取消")]))),_:1})])])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}]]);export{A as default};
