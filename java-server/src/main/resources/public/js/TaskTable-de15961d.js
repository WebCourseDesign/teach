import{d as e,X as a,u as t,Y as l,c as s,e as o,Z as u,O as r,w as d,k as n,f as p,F as i,z as m,G as c,V as v,a5 as f,o as k,j as _,x as y,y as h,I as b,a2 as I,A as g,J as T,D as j,P as E,Q as V,E as w,m as N,N as x,_ as C}from"./index-ebbc268c.js";/* empty css                *//* empty css                  *//* empty css            *//* empty css               *//* empty css                    *//* empty css              *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                     *//* empty css                 */import{j as R}from"./teachingServ-68e3f6d8.js";import{r as D}from"./request-c45980cc.js";import{g as H}from"./taskSubmitServ-494c80a6.js";const L={class:"base_form"},U={class:"base_query_oneLine"},Y={class:"query_left"},A={class:"table_center",style:{"margin-top":"5px"}},O={key:0,style:{display:"flex","justify-content":"center","margin-top":"10px"}},$={class:"table_center",style:{"margin-top":"5px"}},S={style:{display:"flex","justify-content":"center","margin-top":"10px"}},P=C(e({__name:"TaskTable",setup(e){const C=a(!1);a([]);const P=a([]);a("");const B=a([]),q=a([]);a("");const M=a({Authorization:""}),z=a({taskId:0,state:0,taskNo:"",taskPath:"",taskName:"",overTime:"",course:{courseId:"",num:"",teacher:{teacherId:"",person:{personId:"",num:""},course:[]}}}),F=()=>{z.value={taskId:0,state:0,taskNo:"",taskPath:"",taskName:"",overTime:"",course:{courseId:"",num:"",teacher:{teacherId:"",person:{personId:"",num:""},course:[]}}}},G=t(),J=()=>{D({url:"/api/task/getTasksByTeacher",method:"get"}).then((e=>{B.value=e.data.data}))},Q=()=>{var e;(e=z.value,D({url:"/api/task/task",method:"post",data:e})).then((e=>{C.value=!1,J()})),F()},X=()=>{D({url:"/api/task/getTasksByStudent",method:"get"}).then((e=>{B.value=e.data.data}))},Z=f();return l((()=>{G.$state.userInfo.roles.includes("ROLE_TEACHER")&&(J(),R().then((e=>{P.value=e.data.data}))),G.$state.userInfo.roles.includes("ROLE_STUDENT")&&(X(),H().then((e=>{q.value=e.data.data}))),M.value.Authorization=`Bearer ${t().userInfo.jwtToken}`})),(e,a)=>{const t=m,l=b,f=I,R=g,D=T,H=c,J=j,K=E,W=V,ee=w,ae=N,te=x,le=v;return k(),s(i,null,[o("div",L,[a[19]||(a[19]=o("div",{class:"base_header"},[o("div",{class:"blue_column"}),o("div",{class:"base_title"},"作业管理")],-1)),o("div",U,[o("div",Y,[u(G).$state.userInfo.roles.includes("ROLE_TEACHER")?(k(),r(t,{key:0,class:"commButton",type:"primary",onClick:a[0]||(a[0]=e=>(C.value=!0,void F()))},{default:d((()=>a[9]||(a[9]=[_("发布作业")]))),_:1})):n("",!0)]),a[10]||(a[10]=o("div",{class:"query_right"},null,-1))]),o("div",A,[p(H,{data:B.value},{default:d((()=>[p(l,{label:"id",prop:"taskId"}),p(l,{label:"作业名称",prop:"taskName"}),p(l,{label:"作业编号",prop:"taskNo"}),p(l,{label:"上传路径",prop:"taskPath"}),p(l,{label:"课程",prop:"course.name"}),p(l,{label:"状态",prop:"state"},{default:d((e=>[0===e.row.state?(k(),r(f,{key:0,type:"warning"},{default:d((()=>a[11]||(a[11]=[_("无人提交")]))),_:1})):n("",!0),1===e.row.state?(k(),r(f,{key:1,type:"success"},{default:d((()=>a[12]||(a[12]=[_("有提交")]))),_:1})):n("",!0),2===e.row.state?(k(),r(f,{key:2,type:"danger"},{default:d((()=>a[13]||(a[13]=[_("正在批改")]))),_:1})):n("",!0),3===e.row.state?(k(),r(f,{key:3,type:"danger"},{default:d((()=>a[14]||(a[14]=[_("批改完成")]))),_:1})):n("",!0)])),_:1}),p(l,{label:"到期时间",prop:"overTime"}),p(l,{label:"操作"},{default:d((e=>[p(D,null,{default:d((()=>[u(G).$state.userInfo.roles.includes("ROLE_TEACHER")?(k(),r(t,{key:0,onClick:a=>{return t=e.row,z.value=t,void(C.value=!0);var t},type:"success"},{default:d((()=>a[15]||(a[15]=[_("编辑")]))),_:2},1032,["onClick"])):n("",!0),u(G).$state.userInfo.roles.includes("ROLE_TEACHER")&&0!=e.row.state?(k(),r(t,{key:1,onClick:a[1]||(a[1]=e=>{Z.push({path:"/correcting-panel"})}),type:"warning"},{default:d((()=>a[16]||(a[16]=[_("批改")]))),_:1})):n("",!0),u(G).$state.userInfo.roles.includes("ROLE_STUDENT")&&3!=e.row.state?(k(),r(R,{key:2,headers:M.value,action:"http://localhost:22222/api/task/upload/"+e.row.taskId,"on-success":X,accept:"application/pdf"},{trigger:d((()=>[p(t,{type:"primary"},{default:d((()=>a[17]||(a[17]=[_("select file")]))),_:1})])),_:2},1032,["headers","action"])):n("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data"])]),u(G).$state.userInfo.roles.includes("ROLE_STUDENT")?(k(),s("div",O,a[18]||(a[18]=[o("h2",null,"历史作业记录",-1)]))):n("",!0),o("div",$,[p(H,{data:q.value},{default:d((()=>[p(l,{label:"id",prop:"id"}),p(l,{label:"作业名称",prop:"task.taskName"}),p(l,{label:"作业编号",prop:"task.taskNo"}),p(l,{label:"课程",prop:"task.course.name"}),p(l,{label:"成绩"},{default:d((e=>[o("span",null,y(e.row.score),1)])),_:1})])),_:1},8,["data"])])]),p(le,{id:"favDialog",modelValue:C.value,"onUpdate:modelValue":a[8]||(a[8]=e=>C.value=e),width:"400px"},{header:d((()=>a[20]||(a[20]=[o("h1",null,"作业添加修改对话框",-1)]))),default:d((()=>[p(te,{"label-width":"80px",model:z.value,ref:"form"},{default:d((()=>[p(K,{label:"作业编号"},{default:d((()=>[p(J,{modelValue:z.value.taskNo,"onUpdate:modelValue":a[2]||(a[2]=e=>z.value.taskNo=e)},null,8,["modelValue"])])),_:1}),p(K,{label:"过期时间"},{default:d((()=>[p(W,{type:"datetime",modelValue:z.value.overTime,"onUpdate:modelValue":a[3]||(a[3]=e=>z.value.overTime=e),placeholder:"选择日期时间",format:"YYYY/MM/DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1}),p(K,{label:"作业名称"},{default:d((()=>[p(J,{modelValue:z.value.taskName,"onUpdate:modelValue":a[4]||(a[4]=e=>z.value.taskName=e)},null,8,["modelValue"])])),_:1}),p(K,{label:"上传路径"},{default:d((()=>[p(J,{modelValue:z.value.taskPath,"onUpdate:modelValue":a[5]||(a[5]=e=>z.value.taskPath=e),placeholder:"上传路径"},null,8,["modelValue"])])),_:1}),p(K,{label:"课程"},{default:d((()=>[p(ae,{modelValue:z.value.course.courseId,"onUpdate:modelValue":a[6]||(a[6]=e=>z.value.course.courseId=e)},{default:d((()=>[(k(!0),s(i,null,h(P.value,(e=>(k(),r(ee,{key:e.courseId,label:e.name,value:e.courseId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),o("div",S,[p(t,{type:"primary",onClick:Q},{default:d((()=>a[21]||(a[21]=[_("确认")]))),_:1}),p(t,{onClick:a[7]||(a[7]=e=>C.value=!1)},{default:d((()=>a[22]||(a[22]=[_("取消")]))),_:1})])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-7dd648ef"]]);export{P as default};
