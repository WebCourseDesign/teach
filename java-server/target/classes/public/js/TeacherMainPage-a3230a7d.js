import{d as e,K as a,u as s,L as l,M as n,C as t,c,f as u,e as r,w as i,s as d,o,k as p,G as v,l as f,N as m,H as b,I as y,R as h,D as g,x as k,P as _,_ as C}from"./index-ed299ca2.js";/* empty css              *//* empty css             */import{a as w}from"./teachingServ-8a53b20e.js";import{g as j,a as x,d as I}from"./absenceServ-fa07f525.js";import"./request-1673f500.js";const $={class:"base_form"},q={class:"dashboard-container"},S={class:"card-header"},z={key:0,class:"teacher-info"},B=["src"],M={class:"info-details"},N={class:"card-header"},P={class:"course-list"},A={key:1,class:"course-items"},D={key:0,class:"more-courses"},G={class:"card-header"},H={class:"absence-list"},K={key:1,class:"absence-items"},L={class:"absence-content"},R={class:"absence-info"},T={class:"absence-actions"},U={key:0,class:"more-absences"},E={class:"dashboard-container"},F={class:"button-group"},J=C(e({__name:"TeacherMainPage",setup(e){const C=a(),J=a("");a();const O=a([]),Q=a([]),V=s(),W=async()=>{const e=document.querySelector("#file");if(!e||!e.files||0===e.files.length)return void h.error("请选择文件");const a=e.files[0];if(0===(await g(C.value.personId+".jpg",a)).code){h.success("上传成功");const e=await t(C.value.personId+".jpg");J.value=e.data}else h.error("上传失败")};return l((async()=>{try{if(V.$state.userInfo.username){const e=await n("/api/base/getByUsername",{username:V.$state.userInfo.username});if(C.value=e.data,C.value.personId){const e=await t(C.value.personId+".jpg");J.value=e.data,null!=J&&(J.value=J.value.replace("data:image/png;base64","data:image/jpeg;base64"))}}const e=await w();O.value=e.data.data;const a=await j();Q.value=a.filter((e=>0===e.approved)).slice(0,2)}catch(e){}})),(e,a)=>{const s=k,l=d,n=_;return o(),c("div",$,[a[33]||(a[33]=u("div",{class:"base_header"},[u("div",{class:"blue_column"}),u("div",{class:"base_title"},"教师工作台")],-1)),u("div",q,[r(l,{class:"info-card"},{header:i((()=>[u("div",S,[a[9]||(a[9]=u("span",null,"教师信息",-1)),r(s,{text:"",onClick:a[0]||(a[0]=e=>(()=>{const e=document.querySelector("#file");e&&e.click()})())},{default:i((()=>a[8]||(a[8]=[p("上传头像")]))),_:1})])])),default:i((()=>{var e,s,l,n,t,r;return[C.value?(o(),c("div",z,[u("input",{type:"file",id:"file",accept:"image/jpeg",style:{display:"none"},onChange:W},null,32),u("img",{src:J.value||"/user.png",class:"avatar",alt:"avatar"},null,8,B),u("div",M,[u("p",null,[a[10]||(a[10]=u("b",null,"工号:",-1)),p(" "+v(null==(e=C.value)?void 0:e.num),1)]),u("p",null,[a[11]||(a[11]=u("b",null,"姓名:",-1)),p(" "+v(null==(s=C.value)?void 0:s.name),1)]),u("p",null,[a[12]||(a[12]=u("b",null,"学院:",-1)),p(" "+v(null==(l=C.value)?void 0:l.dept),1)]),u("p",null,[a[13]||(a[13]=u("b",null,"职称:",-1)),p(" "+v(null==(n=C.value)?void 0:n.title),1)]),u("p",null,[a[14]||(a[14]=u("b",null,"学位:",-1)),p(" "+v(null==(t=C.value)?void 0:t.degree),1)]),u("p",null,[a[15]||(a[15]=u("b",null,"邮箱:",-1)),p(" "+v(null==(r=C.value)?void 0:r.email),1)])])])):f("",!0)]})),_:1}),r(l,{class:"stat-card"},{header:i((()=>[u("div",N,[a[17]||(a[17]=u("span",null,"我的课程",-1)),r(s,{text:"",onClick:a[1]||(a[1]=a=>e.$router.push("/course-panel"))},{default:i((()=>a[16]||(a[16]=[p("查看详情")]))),_:1})])])),default:i((()=>[u("div",P,[O.value.length?(o(),c("div",A,[(o(!0),c(b,null,y(O.value.slice(0,3),((e,s)=>(o(),c("div",{key:e.courseId,class:"course-item"},[u("span",null,v(e.name),1),a[18]||(a[18]=u("br",null,null,-1)),u("span",null," 课程号: "+v(e.num),1),u("span",null," 学分: "+v(e.credit),1)])))),128)),O.value.length>4?(o(),c("div",D,[u("button",{onClick:a[2]||(a[2]=a=>e.$router.push("/course-panel"))},"更多")])):f("",!0)])):(o(),m(n,{key:0,description:"暂无课程"}))])])),_:1}),r(l,{class:"stat-card"},{header:i((()=>[u("div",G,[a[20]||(a[20]=u("span",null,"新请假申请",-1)),r(s,{text:"",onClick:a[3]||(a[3]=a=>e.$router.push("/absence-panel"))},{default:i((()=>a[19]||(a[19]=[p("查看详情")]))),_:1})])])),default:i((()=>[u("div",H,[Q.value.length?(o(),c("div",K,[(o(!0),c(b,null,y(Q.value,(e=>(o(),c("div",{key:e.id,class:"absence-item"},[u("div",L,[u("div",R,[u("p",null,[a[21]||(a[21]=u("b",null,"学生:",-1)),p(" "+v(e.student.numName),1)]),u("p",null,[a[22]||(a[22]=u("b",null,"开始时间:",-1)),p(" "+v(e.start),1)]),u("p",null,[a[23]||(a[23]=u("b",null,"结束时间:",-1)),p(" "+v(e.end),1)]),u("p",null,[a[24]||(a[24]=u("b",null,"原因:",-1)),p(" "+v(e.reason),1)])]),u("div",T,[r(s,{type:"success",size:"small",class:"vertical-text",onClick:a=>(async e=>{try{await x(e),h.success("已通过请假申请");const a=await j();Q.value=a.filter((e=>0===e.approved)).slice(0,4)}catch(a){h.error("操作失败")}})(e)},{default:i((()=>a[25]||(a[25]=[p("通过")]))),_:2},1032,["onClick"]),r(s,{type:"danger",size:"small",class:"vertical-text",onClick:a=>(async e=>{try{await I(e),h.success("已拒绝请假申请");const a=await j();Q.value=a.filter((e=>0===e.approved)).slice(0,4)}catch(a){h.error("操作失败")}})(e)},{default:i((()=>a[26]||(a[26]=[p("驳回")]))),_:2},1032,["onClick"])])])])))),128)),4===Q.value.length?(o(),c("div",U,a[27]||(a[27]=[u("span",null,"...",-1)]))):f("",!0)])):(o(),m(n,{key:0,description:"暂无新请假申请"}))])])),_:1})]),u("div",E,[r(l,{class:"quick-access"},{header:i((()=>a[28]||(a[28]=[u("div",{class:"card-header"},[u("span",null,"快速入口")],-1)]))),default:i((()=>[u("div",F,[r(s,{type:"warning",onClick:a[4]||(a[4]=a=>e.$router.push("/course-panel"))},{default:i((()=>a[29]||(a[29]=[p("课程管理")]))),_:1}),r(s,{type:"primary",onClick:a[5]||(a[5]=a=>e.$router.push("/score-table-panel"))},{default:i((()=>a[30]||(a[30]=[p("成绩管理")]))),_:1}),r(s,{type:"success",onClick:a[6]||(a[6]=a=>e.$router.push("/task-panel"))},{default:i((()=>a[31]||(a[31]=[p("作业管理")]))),_:1}),r(s,{type:"danger",onClick:a[7]||(a[7]=a=>e.$router.push("/absence-panel"))},{default:i((()=>a[32]||(a[32]=[p("考勤管理")]))),_:1})])])),_:1})])])}}}),[["__scopeId","data-v-565ffd40"]]);export{J as default};
