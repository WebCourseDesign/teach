import{M as e,d as l,K as a,u as t,L as u,c as o,f as d,ak as n,N as s,w as r,l as i,e as p,H as c,x as m,a6 as v,Y as f,af as _,o as h,k as y,I as b,R as V,n as I,p as g,a7 as j,$ as x,al as k,a0 as C,X as U}from"./index-ed299ca2.js";/* empty css                *//* empty css              *//* empty css                     *//* empty css                 *//* empty css                *//* empty css            *//* empty css                  *//* empty css               */import{r as w}from"./request-1673f500.js";import{f as $}from"./teachingServ-8a53b20e.js";const E=async l=>(await e("/api/innovation/list",{studentId:l})).data,L={class:"base_form"},R={class:"base_query_oneLine"},q={class:"query_left"},D={key:0,class:"query_right"},M={class:"table_center",style:{"margin-top":"5px"}},N={style:{display:"flex","justify-content":"center","margin-top":"10px"}},P=l({__name:"InnovationTable",setup(e){const l=a(!1),P=a([]),A=a(""),B=a([]),O=a({id:0,student:{studentId:"",person:{personId:"",num:""}},socialPractice:"",competition:"",technology:"",lecture:"",project:"",internship:""}),H=()=>{O.value={id:0,student:{studentId:"",person:{personId:"",num:""}},socialPractice:"",competition:"",technology:"",lecture:"",project:"",internship:""}},T=t(),F=()=>{E().then((e=>{B.value=e;T.$state.userInfo.roles}))},G=a(!1),J=()=>{var e;K(O.value.student.studentId)?(e=O.value,w({url:"/api/innovation",method:"post",data:e})).then((e=>{l.value=!1,F()})):V.error({message:"该学生已存在"}),H(),G.value=!1},K=async e=>{let l=!1;const a=await E(e);return 1===a.length&&(O.value=a[0],l=!0),a.length>1&&(l=!1),a&&0!==a.length||(H(),O.value.student.studentId=e,l=!0),l},S=e=>{(e=>w({url:`/api/innovation/${e}`,method:"delete"}))(e).then((e=>{F()}))};return u((()=>{(async()=>{$().then((e=>{P.value=e}))})(),F()})),(e,a)=>{const t=m,u=I,V=g,w=j,$=v,X=x,Y=k,z=C,Q=f,W=U,Z=_;return h(),o(c,null,[d("div",L,[a[19]||(a[19]=d("div",{class:"base_header"},[d("div",{class:"blue_column"}),d("div",{class:"base_title"},"创新实践管理")],-1)),d("div",R,[d("div",q,[n(T).$state.userInfo.roles.includes("ROLE_ADMIN")?(h(),s(t,{key:0,class:"commButton",type:"primary",onClick:a[0]||(a[0]=e=>(l.value=!0,H(),void(G.value=!1)))},{default:r((()=>a[14]||(a[14]=[y("添加")]))),_:1})):i("",!0)]),n(T).$state.userInfo.roles.includes("ROLE_ADMIN")||n(T).$state.userInfo.roles.includes("ROLE_TEACHER")?(h(),o("div",D,[p($,{inline:!0},{default:r((()=>[p(w,{label:"学生"},{default:r((()=>[p(V,{modelValue:A.value,"onUpdate:modelValue":a[1]||(a[1]=e=>A.value=e)},{default:r((()=>[(h(!0),o(c,null,b(P.value,(e=>(h(),s(u,{label:e.title,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(w,null,{default:r((()=>[p(t,{type:"default",class:"commButton",onClick:a[2]||(a[2]=e=>{E(A.value).then((e=>{B.value=e}))})},{default:r((()=>a[15]||(a[15]=[y("查询")]))),_:1}),p(t,{type:"default",class:"commButton",onClick:a[3]||(a[3]=e=>(A.value="",void F()))},{default:r((()=>a[16]||(a[16]=[y("重置")]))),_:1})])),_:1})])),_:1})])):i("",!0)]),d("div",M,[p(Q,{data:B.value},{default:r((()=>[p(X,{label:"id",prop:"id"}),p(X,{label:"学生",prop:"student.numName"}),p(X,{label:"社会实践",prop:"socialPractice"}),p(X,{label:"学科竞赛",prop:"competition"}),p(X,{label:"科技成果",prop:"technology"}),p(X,{label:"培训讲座",prop:"lecture"}),p(X,{label:"创新项目",prop:"project"}),p(X,{label:"校外实习",prop:"internship"}),n(T).$state.userInfo.roles.includes("ROLE_ADMIN")?(h(),s(X,{key:0,label:"操作"},{default:r((e=>[p(z,null,{default:r((()=>[p(t,{onClick:a=>{return t=e.row,O.value=t,G.value=!0,void(l.value=!0);var t},type:"success"},{default:r((()=>a[17]||(a[17]=[y("编辑")]))),_:2},1032,["onClick"]),p(Y,{title:"确定要删除吗?",onConfirm:l=>S(e.row.id)},{reference:r((()=>[p(t,{type:"danger"},{default:r((()=>a[18]||(a[18]=[y("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})):i("",!0)])),_:1},8,["data"])])]),p(Z,{id:"favDialog",modelValue:l.value,"onUpdate:modelValue":a[13]||(a[13]=e=>l.value=e),width:"400px"},{header:r((()=>a[20]||(a[20]=[d("h1",null,"荣誉添加修改对话框",-1)]))),default:r((()=>[p($,{"label-width":"80px",model:O.value,ref:"form"},{default:r((()=>[p(w,{label:"学生"},{default:r((()=>[p(V,{disabled:G.value,modelValue:O.value.student.studentId,"onUpdate:modelValue":a[4]||(a[4]=e=>O.value.student.studentId=e),placeholder:"请选择...",onChange:a[5]||(a[5]=e=>K(O.value.student.studentId))},{default:r((()=>[(h(!0),o(c,null,b(P.value,(e=>(h(),s(u,{label:e.title,value:e.id},null,8,["label","value"])))),256))])),_:1},8,["disabled","modelValue"])])),_:1}),p(w,{label:"社会实践"},{default:r((()=>[p(W,{modelValue:O.value.socialPractice,"onUpdate:modelValue":a[6]||(a[6]=e=>O.value.socialPractice=e),type:"textarea",placeholder:"社会实践"},null,8,["modelValue"])])),_:1}),p(w,{label:"学科竞赛"},{default:r((()=>[p(W,{modelValue:O.value.competition,"onUpdate:modelValue":a[7]||(a[7]=e=>O.value.competition=e),type:"textarea",placeholder:"学科竞赛"},null,8,["modelValue"])])),_:1}),p(w,{label:"科技成果"},{default:r((()=>[p(W,{modelValue:O.value.technology,"onUpdate:modelValue":a[8]||(a[8]=e=>O.value.technology=e),type:"textarea",placeholder:"科技成果"},null,8,["modelValue"])])),_:1}),p(w,{label:"培训讲座"},{default:r((()=>[p(W,{modelValue:O.value.lecture,"onUpdate:modelValue":a[9]||(a[9]=e=>O.value.lecture=e),type:"textarea",placeholder:"培训讲座"},null,8,["modelValue"])])),_:1}),p(w,{label:"创新项目"},{default:r((()=>[p(W,{modelValue:O.value.project,"onUpdate:modelValue":a[10]||(a[10]=e=>O.value.project=e),type:"textarea",placeholder:"创新项目"},null,8,["modelValue"])])),_:1}),p(w,{label:"校外实习"},{default:r((()=>[p(W,{modelValue:O.value.internship,"onUpdate:modelValue":a[11]||(a[11]=e=>O.value.internship=e),type:"textarea",placeholder:"校外实习"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),d("div",N,[p(t,{type:"primary",onClick:J},{default:r((()=>a[21]||(a[21]=[y("确认")]))),_:1}),p(t,{onClick:a[12]||(a[12]=e=>l.value=!1)},{default:r((()=>a[22]||(a[22]=[y("取消")]))),_:1})])])),_:1},8,["modelValue"])],64)}}});export{P as default};
