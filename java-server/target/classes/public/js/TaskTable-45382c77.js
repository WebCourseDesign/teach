import{d as e,X as a,u as t,Y as l,c as s,e as o,Z as u,O as r,w as d,k as n,f as p,F as i,z as m,G as c,V as v,a5 as k,o as f,j as _,x as h,y,M as b,I,a2 as g,A as T,J as j,D as E,P as V,Q as N,E as w,m as x,N as C,_ as R}from"./index-7ed7b84e.js";/* empty css                *//* empty css                  *//* empty css            *//* empty css               *//* empty css                    *//* empty css              *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                     *//* empty css                 */import{j as D}from"./teachingServ-91173710.js";import{r as H}from"./request-e26a986b.js";import{g as L}from"./taskSubmitServ-ac9ac369.js";const U={class:"base_form"},Y={class:"base_query_oneLine"},A={class:"query_left"},O={class:"table_center",style:{"margin-top":"5px"}},$={key:0,style:{display:"flex","justify-content":"center","margin-top":"10px"}},P={class:"table_center",style:{"margin-top":"5px"}},S={style:{display:"flex","justify-content":"center","margin-top":"10px"}},B=R(e({__name:"TaskTable",setup(e){const R=a(!1);a([]);const B=a([]);a("");const M=a([]),q=a([]);a("");const z=a({Authorization:""}),F=a({taskId:0,state:0,taskNo:"",taskPath:"",taskName:"",overTime:"",course:{courseId:"",num:"",teacher:{teacherId:"",person:{personId:"",num:""},course:[]}}}),G=()=>{F.value={taskId:0,state:0,taskNo:"",taskPath:"D:/teach/web/2023/attach",taskName:"",overTime:"",course:{courseId:"",num:"",teacher:{teacherId:"",person:{personId:"",num:""},course:[]}}}},J=t(),Q=()=>{H({url:"/api/task/getTasksByTeacher",method:"get"}).then((e=>{M.value=e.data.data}))},X=()=>{var e;""!=F.value.course.courseId&&""!=F.value.overTime&&""!=F.value.taskName&&""!=F.value.taskNo&&""!=F.value.taskPath?((e=F.value,H({url:"/api/task/task",method:"post",data:e})).then((e=>{R.value=!1,Q()})),G()):b.alert("请填写完整信息")},Z=()=>{H({url:"/api/task/getTasksByStudent",method:"get"}).then((e=>{M.value=e.data.data}))},K=k();return l((()=>{J.$state.userInfo.roles.includes("ROLE_TEACHER")&&(Q(),D().then((e=>{B.value=e.data.data}))),J.$state.userInfo.roles.includes("ROLE_STUDENT")&&(Z(),L().then((e=>{q.value=e.data.data}))),z.value.Authorization=`Bearer ${t().userInfo.jwtToken}`})),(e,a)=>{const t=m,l=I,k=g,b=T,D=j,H=c,L=E,Q=V,W=N,ee=w,ae=x,te=C,le=v;return f(),s(i,null,[o("div",U,[a[19]||(a[19]=o("div",{class:"base_header"},[o("div",{class:"blue_column"}),o("div",{class:"base_title"},"作业管理")],-1)),o("div",Y,[o("div",A,[u(J).$state.userInfo.roles.includes("ROLE_TEACHER")?(f(),r(t,{key:0,class:"commButton",type:"primary",onClick:a[0]||(a[0]=e=>(R.value=!0,void G()))},{default:d((()=>a[9]||(a[9]=[_("发布作业")]))),_:1})):n("",!0)]),a[10]||(a[10]=o("div",{class:"query_right"},null,-1))]),o("div",O,[p(H,{data:M.value},{default:d((()=>[p(l,{label:"id",prop:"taskId"}),p(l,{label:"作业名称",prop:"taskName"}),p(l,{label:"作业编号",prop:"taskNo"}),p(l,{label:"上传路径",prop:"taskPath"}),p(l,{label:"课程",prop:"course.name"}),p(l,{label:"状态",prop:"state"},{default:d((e=>[0===e.row.state?(f(),r(k,{key:0,type:"warning"},{default:d((()=>a[11]||(a[11]=[_("无人提交")]))),_:1})):n("",!0),1===e.row.state?(f(),r(k,{key:1,type:"success"},{default:d((()=>a[12]||(a[12]=[_("有提交")]))),_:1})):n("",!0),2===e.row.state?(f(),r(k,{key:2,type:"danger"},{default:d((()=>a[13]||(a[13]=[_("正在批改")]))),_:1})):n("",!0),3===e.row.state?(f(),r(k,{key:3,type:"danger"},{default:d((()=>a[14]||(a[14]=[_("批改完成")]))),_:1})):n("",!0)])),_:1}),p(l,{label:"到期时间",prop:"overTime"}),p(l,{label:"操作"},{default:d((e=>[p(D,null,{default:d((()=>[u(J).$state.userInfo.roles.includes("ROLE_TEACHER")?(f(),r(t,{key:0,onClick:a=>{return t=e.row,F.value=t,void(R.value=!0);var t},type:"success"},{default:d((()=>a[15]||(a[15]=[_("编辑")]))),_:2},1032,["onClick"])):n("",!0),u(J).$state.userInfo.roles.includes("ROLE_TEACHER")&&0!=e.row.state?(f(),r(t,{key:1,onClick:a[1]||(a[1]=e=>{K.push({path:"/correcting-panel"})}),type:"warning"},{default:d((()=>a[16]||(a[16]=[_("批改")]))),_:1})):n("",!0),u(J).$state.userInfo.roles.includes("ROLE_STUDENT")&&3!=e.row.state?(f(),r(b,{key:2,headers:z.value,action:"http://202.194.7.29:22222/api/task/upload/"+e.row.taskId,"on-success":Z,accept:"application/pdf"},{trigger:d((()=>[p(t,{type:"primary"},{default:d((()=>a[17]||(a[17]=[_("select file")]))),_:1})])),_:2},1032,["headers","action"])):n("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data"])]),u(J).$state.userInfo.roles.includes("ROLE_STUDENT")?(f(),s("div",$,a[18]||(a[18]=[o("h2",null,"历史作业记录",-1)]))):n("",!0),o("div",P,[p(H,{data:q.value},{default:d((()=>[p(l,{label:"id",prop:"id"}),p(l,{label:"作业名称",prop:"task.taskName"}),p(l,{label:"作业编号",prop:"task.taskNo"}),p(l,{label:"课程",prop:"task.course.name"}),p(l,{label:"成绩"},{default:d((e=>[o("span",null,h(e.row.score),1)])),_:1})])),_:1},8,["data"])])]),p(le,{id:"favDialog",modelValue:R.value,"onUpdate:modelValue":a[8]||(a[8]=e=>R.value=e),width:"400px"},{header:d((()=>a[20]||(a[20]=[o("h1",null,"作业添加修改对话框",-1)]))),default:d((()=>[p(te,{"label-width":"80px",model:F.value,ref:"form"},{default:d((()=>[p(Q,{label:"作业编号"},{default:d((()=>[p(L,{modelValue:F.value.taskNo,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value.taskNo=e)},null,8,["modelValue"])])),_:1}),p(Q,{label:"过期时间"},{default:d((()=>[p(W,{type:"datetime",modelValue:F.value.overTime,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value.overTime=e),placeholder:"选择日期时间",format:"YYYY/MM/DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1}),p(Q,{label:"作业名称"},{default:d((()=>[p(L,{modelValue:F.value.taskName,"onUpdate:modelValue":a[4]||(a[4]=e=>F.value.taskName=e)},null,8,["modelValue"])])),_:1}),p(Q,{label:"上传路径"},{default:d((()=>[p(L,{modelValue:F.value.taskPath,"onUpdate:modelValue":a[5]||(a[5]=e=>F.value.taskPath=e),placeholder:"上传路径"},null,8,["modelValue"])])),_:1}),p(Q,{label:"课程"},{default:d((()=>[p(ae,{modelValue:F.value.course.courseId,"onUpdate:modelValue":a[6]||(a[6]=e=>F.value.course.courseId=e)},{default:d((()=>[(f(!0),s(i,null,y(B.value,(e=>(f(),r(ee,{key:e.courseId,label:e.name,value:e.courseId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),o("div",S,[p(t,{type:"primary",onClick:X},{default:d((()=>a[21]||(a[21]=[_("确认")]))),_:1}),p(t,{onClick:a[7]||(a[7]=e=>R.value=!1)},{default:d((()=>a[22]||(a[22]=[_("取消")]))),_:1})])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-9c092409"]]);export{B as default};
