import{d as e,am as a,K as l,u as s,L as t,c as d,f as u,ak as o,N as r,w as n,l as i,e as p,H as v,x as m,a6 as c,Y as f,af as _,o as y,k as b,I as k,a5 as I,n as Y,p as h,a7 as E,$ as D,O as V,a0 as C,X as j,a8 as H}from"./index-be5cb234.js";/* empty css                *//* empty css                    *//* empty css              *//* empty css                     *//* empty css                 *//* empty css            *//* empty css                  *//* empty css               */import{f as w}from"./teachingServ-654619e3.js";import{g as x,b as M,a as R,d as T}from"./absenceServ-27f6f014.js";import"./request-9dd860e1.js";const g={class:"base_form"},L={class:"base_query_oneLine"},O={class:"query_left"},$={key:0,class:"query_right"},A={class:"table_center",style:{"margin-top":"5px"}},N={style:{display:"flex","justify-content":"center","margin-top":"10px"}},U=e({__name:"AbsenceTable",setup(e){const U=a((()=>K.$state.userInfo.roles.includes("ROLE_ADMIN")||K.$state.userInfo.roles.includes("ROLE_TEACHER"))),q=l(!1),B=l([]),S=l(""),F=l([]),G=l({id:0,student:{studentId:"",person:{personId:"",num:""}},reason:"",start:void 0,end:void 0,approved:0,approver:{personId:"",num:""},approvedTime:void 0}),J=()=>{G.value={id:0,student:{studentId:"",person:{personId:"",num:""}},reason:"",start:void 0,end:void 0,approved:0,approver:{personId:"",num:""},approvedTime:void 0}},K=s(),X=()=>{x().then((e=>{F.value=e}))},z=e=>{G.value=e,q.value=!0},P=()=>{G.value.start>G.value.end?I.alert("请假开始时间不能大于请假结束时间"):(M(G.value).then((e=>{q.value=!1,X()})),J())};return t((()=>{(async()=>{w().then((e=>{B.value=e}))})(),X()})),(e,a)=>{const l=m,s=Y,t=h,I=E,w=c,M=D,Q=V,W=C,Z=f,ee=j,ae=H,le=_;return y(),d(v,null,[u("div",g,[a[19]||(a[19]=u("div",{class:"base_header"},[u("div",{class:"blue_column"}),u("div",{class:"base_title"},"考勤管理")],-1)),u("div",L,[u("div",O,[o(K).$state.userInfo.roles.includes("ROLE_STUDENT")?(y(),r(l,{key:0,class:"commButton",type:"primary",onClick:a[0]||(a[0]=e=>(q.value=!0,void J()))},{default:n((()=>a[11]||(a[11]=[b("添加")]))),_:1})):i("",!0)]),o(K).$state.userInfo.roles.includes("ROLE_ADMIN")||o(K).$state.userInfo.roles.includes("ROLE_TEACHER")?(y(),d("div",$,[p(w,{inline:!0},{default:n((()=>[p(I,{label:"学生"},{default:n((()=>[p(t,{modelValue:S.value,"onUpdate:modelValue":a[1]||(a[1]=e=>S.value=e)},{default:n((()=>[(y(!0),d(v,null,k(B.value,(e=>(y(),r(s,{label:e.title,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(I,null,{default:n((()=>[p(l,{type:"default",class:"commButton",onClick:a[2]||(a[2]=e=>{x(S.value).then((e=>{F.value=e}))})},{default:n((()=>a[12]||(a[12]=[b("查询")]))),_:1}),p(l,{type:"default",class:"commButton",onClick:a[3]||(a[3]=e=>(S.value="",void X()))},{default:n((()=>a[13]||(a[13]=[b("重置")]))),_:1})])),_:1})])),_:1})])):i("",!0)]),u("div",A,[p(Z,{data:F.value},{default:n((()=>[p(M,{label:"id",prop:"id"}),p(M,{label:"学生",prop:"student.numName"}),p(M,{label:"审批状态",prop:"approved"},{default:n((e=>[0===e.row.approved?(y(),r(Q,{key:0,type:"warning"},{default:n((()=>a[14]||(a[14]=[b("未审批")]))),_:1})):i("",!0),1===e.row.approved?(y(),r(Q,{key:1,type:"success"},{default:n((()=>a[15]||(a[15]=[b("已通过")]))),_:1})):i("",!0),2===e.row.approved?(y(),r(Q,{key:2,type:"danger"},{default:n((()=>a[16]||(a[16]=[b("不同意")]))),_:1})):i("",!0)])),_:1}),p(M,{label:"审批人",prop:"approver.name"}),p(M,{label:"审批时间",prop:"approvedTime"}),p(M,{label:"操作"},{default:n((e=>[p(W,null,{default:n((()=>[o(K).$state.userInfo.roles.includes("ROLE_STUDENT")?(y(),r(l,{key:0,onClick:a=>z(e.row),type:"success",disabled:1===e.row.approved||2===e.row.approved},{default:n((()=>a[17]||(a[17]=[b("编辑")]))),_:2},1032,["onClick","disabled"])):i("",!0),o(K).$state.userInfo.roles.includes("ROLE_ADMIN")||o(K).$state.userInfo.roles.includes("ROLE_TEACHER")?(y(),r(l,{key:1,onClick:a=>z(e.row),type:"success"},{default:n((()=>a[18]||(a[18]=[b("查看学生请假信息")]))),_:2},1032,["onClick"])):i("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data"])])]),p(le,{id:"favDialog",modelValue:q.value,"onUpdate:modelValue":a[10]||(a[10]=e=>q.value=e),width:"400px"},{header:n((()=>a[20]||(a[20]=[u("h1",null,"学生请假表单",-1)]))),default:n((()=>[p(w,{"label-width":"80px",model:G.value,ref:"form"},{default:n((()=>[p(I,{label:"请假原因"},{default:n((()=>[p(ee,{modelValue:G.value.reason,"onUpdate:modelValue":a[4]||(a[4]=e=>G.value.reason=e),type:"textarea",rows:5,disabled:U.value},null,8,["modelValue","disabled"])])),_:1}),p(I,{label:"开始时间"},{default:n((()=>[p(ae,{type:"datetime",modelValue:G.value.start,"onUpdate:modelValue":a[5]||(a[5]=e=>G.value.start=e),placeholder:"选择日期时间",format:"YYYY/MM/DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",disabled:U.value},null,8,["modelValue","disabled"])])),_:1}),p(I,{label:"结束时间"},{default:n((()=>[p(ae,{type:"datetime",modelValue:G.value.end,"onUpdate:modelValue":a[6]||(a[6]=e=>G.value.end=e),placeholder:"选择日期时间",format:"YYYY/MM/DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",disabled:U.value},null,8,["modelValue","disabled"])])),_:1})])),_:1},8,["model"]),u("div",N,[U.value?i("",!0):(y(),r(l,{key:0,type:"primary",onClick:P},{default:n((()=>a[21]||(a[21]=[b("确认")]))),_:1})),U.value?(y(),r(l,{key:1,type:"success",onClick:a[7]||(a[7]=e=>{return a=G.value,void R(a).then((e=>{X(),q.value=!1}));var a})},{default:n((()=>a[22]||(a[22]=[b("同意")]))),_:1})):i("",!0),U.value?(y(),r(l,{key:2,type:"danger",onClick:a[8]||(a[8]=e=>{return a=G.value,void T(a).then((e=>{X(),q.value=!1}));var a})},{default:n((()=>a[23]||(a[23]=[b("不同意")]))),_:1})):i("",!0),p(l,{onClick:a[9]||(a[9]=e=>q.value=!1)},{default:n((()=>a[24]||(a[24]=[b("取消")]))),_:1})])])),_:1},8,["modelValue"])],64)}}});export{U as default};
