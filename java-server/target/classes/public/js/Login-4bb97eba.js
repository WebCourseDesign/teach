import{d as e,g as a,u as s,t,r,a as o,b as i,_ as l,c as n,e as d,w as c,f as p,T as u,E as h,o as m,h as f,i as g,v,j as C,k as b,l as y,m as w,n as A,p as x}from"./index-be5cb234.js";/* empty css            *//* empty css               */import{m as T}from"./messageBox-168aaa44.js";const V="function"==typeof Buffer,U="function"==typeof TextDecoder?new TextDecoder:void 0,k="function"==typeof TextEncoder?new TextEncoder:void 0,E=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),S=(()=>{let e={};return E.forEach(((a,s)=>e[a]=s)),e})(),N=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,F=String.fromCharCode.bind(String),B="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),D=e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")),I=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),_=e=>{let a,s,t,r,o="";const i=e.length%3;for(let l=0;l<e.length;){if((s=e.charCodeAt(l++))>255||(t=e.charCodeAt(l++))>255||(r=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");a=s<<16|t<<8|r,o+=E[a>>18&63]+E[a>>12&63]+E[a>>6&63]+E[63&a]}return i?o.slice(0,i-3)+"===".substring(i):o},j="function"==typeof btoa?e=>btoa(e):V?e=>Buffer.from(e,"binary").toString("base64"):_,P=V?e=>Buffer.from(e).toString("base64"):e=>{let a=[];for(let s=0,t=e.length;s<t;s+=4096)a.push(F.apply(null,e.subarray(s,s+4096)));return j(a.join(""))},L=e=>{if(e.length<2)return(a=e.charCodeAt(0))<128?e:a<2048?F(192|a>>>6)+F(128|63&a):F(224|a>>>12&15)+F(128|a>>>6&63)+F(128|63&a);var a=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return F(240|a>>>18&7)+F(128|a>>>12&63)+F(128|a>>>6&63)+F(128|63&a)},R=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,M=e=>e.replace(R,L),z=V?e=>Buffer.from(e,"utf8").toString("base64"):k?e=>P(k.encode(e)):e=>j(M(e)),Z=(e,a=!1)=>a?D(z(e)):z(e),H=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,O=e=>{switch(e.length){case 4:var a=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return F(55296+(a>>>10))+F(56320+(1023&a));case 3:return F((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return F((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},q=e=>e.replace(H,O),G=e=>{if(e=e.replace(/\s+/g,""),!N.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let a,s,t,r="";for(let o=0;o<e.length;)a=S[e.charAt(o++)]<<18|S[e.charAt(o++)]<<12|(s=S[e.charAt(o++)])<<6|(t=S[e.charAt(o++)]),r+=64===s?F(a>>16&255):64===t?F(a>>16&255,a>>8&255):F(a>>16&255,a>>8&255,255&a);return r},J="function"==typeof atob?e=>atob(I(e)):V?e=>Buffer.from(e,"base64").toString("binary"):G,K=V?e=>B(Buffer.from(e,"base64")):e=>B(J(e).split("").map((e=>e.charCodeAt(0)))),Q=V?e=>Buffer.from(e,"base64").toString("utf8"):U?e=>U.decode(K(e)):e=>q(J(e)),W=e=>I(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),X=e=>Q(W(e)),Y=Z,$=X;function ee(e){return!!e||"您必须输入用户名密码"}const ae=e({data:()=>({username:"",password:"",valiCode:"",pageType:1,id:0,jwt:"",img:"",funId:"",vueName:"",loginCode:"",email:"",messageCode:"",showSlider:!1,remember:!0,role:"STUDENT",perName:"",rules:[ee]}),beforeMount(){this.pageType=1},async created(){const e=await a();this.id=e.validateCodeId,this.img=e.img;const t=s();t.remember?(this.username=$(t.usernameSave),this.password=$(t.passwordSave),this.remember=!0):(this.username="",this.password="",this.remember=!1)},methods:{async changeValiCode(){const e=await a();this.id=e.validateCodeId,this.img=e.img,this.valiCode=""},changeUser(){this.password="123456"},backLogin(){this.username="",this.password="",this.valiCode="",this.pageType=1},forgetPass(){this.username="",this.password="",this.valiCode="",this.pageType=2},pageRegister(){this.username="",this.password="",this.valiCode="",this.pageType=3},async initPassword(){let e=await t({validateCodeId:this.id,validateCode:this.valiCode});if(0!=e.code)return T(this,e.msg),void this.changeValiCode();""!=this.username&&null!=this.username?""!=this.email&&null!=this.email?(e=await r({username:this.username,email:this.email}),0==e.code?(T(this,"初始密码已发送至您的邮箱，请注意查收"),this.changeValiCode(),this.pageType=1):T(this,e.msg)):T(this,"邮箱为空,请填写邮箱"):T(this,"账号为空,请填写账号")},async register(){let e=await t({validateCodeId:this.id,validateCode:this.valiCode});if(0!=e.code)return T(this,e.msg),void this.changeValiCode();""!=this.username&&null!=this.username?""!=this.password&&null!=this.password?""!=this.perName&&null!=this.perName?""!=this.email&&null!=this.email?""!=this.role&&null!=this.role?(e=await o({username:this.username,password:this.password,perName:this.perName,email:this.email,role:this.role}),0==e.code?(T(this,"已注册成功！"),this.changeValiCode(),this.pageType=1):T(this,e.msg)):T(this,"角色为空,请选择角色"):T(this,"邮箱为空,请填写邮箱"):T(this,"姓名为空,请填写姓名"):T(this,"账号为空,请填写密码"):T(this,"账号为空,请填写账号")},async loginSubmit(){const e=await t({validateCodeId:this.id,validateCode:this.valiCode});if(0!=e.code)return T(this,e.msg),void this.changeValiCode();if(""==this.username||null==this.username)T(this,"用户名为空");else if(""==this.password||null==this.password)T(this,"密码为空");else{const e=s();try{await e.login(this.username,this.password),await e.setNavi(),this.remember?e.saveAccount(Y(this.username),Y(this.password)):e.removeAccount(),"ROLE_STUDENT"==e.userInfo.roles?i.push({path:"/StudentMainPage"}):"ROLE_TEACHER"==e.userInfo.roles?i.push({path:"/TeacherMainPage"}):i.push({path:"/MainPage"})}catch(a){T(this,"登录失败!")}}}}}),se={class:"login-page flex-col"},te={class:"main-content flex-col align-center justify-center"},re={class:"card"},oe={key:0},ie={class:"form-group"},le={class:"form-group"},ne={class:"form-group captcha"},de={class:"captcha-container"},ce=["src"],pe={class:"form-group"},ue={class:"form-options"},he={class:"action-buttons"},me={key:1},fe={class:"form-group"},ge={class:"form-group"},ve={class:"form-group captcha"},Ce={class:"captcha-container"},be=["src"],ye={class:"form-actions"},we={key:2},Ae={class:"form-group"},xe={class:"form-group"},Te={class:"form-group"},Ve={class:"form-group"},Ue={class:"form-group"},ke={class:"form-group captcha"},Ee={class:"captcha-container"},Se=["src"],Ne={class:"form-actions"};const Fe=l(ae,[["render",function(e,a,s,t,r,o){const i=h,l=A,T=x;return m(),n("div",se,[d(i,{class:"header",height:"70px"},{default:c((()=>a[24]||(a[24]=[p("div",{class:"logo-container"},[p("img",{src:f,alt:"Logo",class:"logo"}),p("span",{class:"welcome-text"},"教学管理系统")],-1)]))),_:1}),p("main",te,[p("div",re,[d(u,{name:"slide-fade",mode:"out-in"},{default:c((()=>[(m(),n("div",{key:e.pageType,class:"form-section"},[1==e.pageType?(m(),n("div",oe,[a[29]||(a[29]=p("h2",{class:"form-title"},"用户登录",-1)),p("div",ie,[a[25]||(a[25]=p("label",{for:"username"},"账号",-1)),g(p("input",{id:"username",class:"form-input","onUpdate:modelValue":a[0]||(a[0]=a=>e.username=a),placeholder:"请输入账号"},null,512),[[v,e.username]])]),p("div",le,[a[26]||(a[26]=p("label",{for:"password"},"密码",-1)),g(p("input",{id:"password",class:"form-input","onUpdate:modelValue":a[1]||(a[1]=a=>e.password=a),type:"password",placeholder:"请输入密码"},null,512),[[v,e.password]])]),p("div",ne,[a[27]||(a[27]=p("label",{for:"valiCode"},"验证码",-1)),p("div",de,[g(p("input",{id:"valiCode",class:"form-input captcha-input","onUpdate:modelValue":a[2]||(a[2]=a=>e.valiCode=a),placeholder:"请输入验证码"},null,512),[[v,e.valiCode]]),p("img",{onClick:a[3]||(a[3]=a=>e.changeValiCode()),src:e.img,alt:"Captcha",class:"captcha-image"},null,8,ce)])]),p("div",pe,[d(T,{onChange:e.changeUser,modelValue:e.username,"onUpdate:modelValue":a[4]||(a[4]=a=>e.username=a),placeholder:"填入示例账户"},{default:c((()=>[d(l,{label:"管理员示例账号",value:"admin"}),d(l,{label:"教师示例账号",value:"200799013517"}),d(l,{label:"学生示例账号",value:"2022030001"})])),_:1},8,["onChange","modelValue"])]),p("div",ue,[p("label",null,[g(p("input",{type:"checkbox","onUpdate:modelValue":a[5]||(a[5]=a=>e.remember=a)},null,512),[[C,e.remember]]),a[28]||(a[28]=b(" 记住密码 "))]),p("span",{onClick:a[6]||(a[6]=a=>e.forgetPass()),class:"forgot-password"},"忘记密码")]),p("div",he,[p("button",{onClick:a[7]||(a[7]=a=>e.loginSubmit()),class:"btn btn-primary"},"登录"),p("button",{onClick:a[8]||(a[8]=a=>e.pageRegister()),class:"btn btn-secondary"},"新用户注册")])])):y("",!0),2==e.pageType?(m(),n("div",me,[a[33]||(a[33]=p("h2",{class:"form-title"},"密码重置",-1)),p("div",fe,[a[30]||(a[30]=p("label",{for:"reset-username"},"登录账号",-1)),g(p("input",{id:"reset-username",class:"form-input","onUpdate:modelValue":a[9]||(a[9]=a=>e.username=a),placeholder:"填写教师号/学号"},null,512),[[v,e.username]])]),p("div",ge,[a[31]||(a[31]=p("label",{for:"email"},"电子邮箱",-1)),g(p("input",{id:"email",class:"form-input","onUpdate:modelValue":a[10]||(a[10]=a=>e.email=a),placeholder:"请输入邮箱"},null,512),[[v,e.email]])]),p("div",ve,[a[32]||(a[32]=p("label",{for:"reset-valiCode"},"验证码",-1)),p("div",Ce,[g(p("input",{id:"reset-valiCode",class:"form-input captcha-input","onUpdate:modelValue":a[11]||(a[11]=a=>e.valiCode=a),placeholder:"请输入验证码"},null,512),[[v,e.valiCode]]),p("img",{onClick:a[12]||(a[12]=a=>e.changeValiCode()),src:e.img,alt:"Captcha",class:"captcha-image"},null,8,be)])]),p("div",ye,[p("button",{onClick:a[13]||(a[13]=a=>e.initPassword()),class:"btn btn-primary"},"初始密码"),p("button",{onClick:a[14]||(a[14]=a=>e.backLogin()),class:"btn btn-secondary"},"返回登录")])])):y("",!0),3==e.pageType?(m(),n("div",we,[a[41]||(a[41]=p("h2",{class:"form-title"},"用户注册",-1)),p("div",Ae,[a[34]||(a[34]=p("label",{for:"register-username"},"账号",-1)),g(p("input",{id:"register-username",class:"form-input","onUpdate:modelValue":a[15]||(a[15]=a=>e.username=a),placeholder:"填写账号"},null,512),[[v,e.username]])]),p("div",xe,[a[35]||(a[35]=p("label",{for:"perName"},"姓名",-1)),g(p("input",{id:"perName",class:"form-input","onUpdate:modelValue":a[16]||(a[16]=a=>e.perName=a),placeholder:"请输入姓名"},null,512),[[v,e.perName]])]),p("div",Te,[a[36]||(a[36]=p("label",{for:"register-password"},"密码",-1)),g(p("input",{id:"register-password",class:"form-input","onUpdate:modelValue":a[17]||(a[17]=a=>e.password=a),type:"password"},null,512),[[v,e.password]])]),p("div",Ve,[a[37]||(a[37]=p("label",{for:"register-email"},"邮箱",-1)),g(p("input",{id:"register-email",class:"form-input","onUpdate:modelValue":a[18]||(a[18]=a=>e.email=a),placeholder:"请输入邮箱"},null,512),[[v,e.email]])]),p("div",Ue,[a[39]||(a[39]=p("label",{for:"role"},"角色",-1)),g(p("select",{id:"role",class:"form-input","onUpdate:modelValue":a[19]||(a[19]=a=>e.role=a)},a[38]||(a[38]=[p("option",{value:"ADMIN"},"管理员",-1),p("option",{value:"STUDENT"},"学生",-1),p("option",{value:"TEACHER"},"教师",-1)]),512),[[w,e.role]])]),p("div",ke,[a[40]||(a[40]=p("label",{for:"register-valiCode"},"验证码",-1)),p("div",Ee,[g(p("input",{id:"register-valiCode",class:"form-input captcha-input","onUpdate:modelValue":a[20]||(a[20]=a=>e.valiCode=a),placeholder:"请输入验证码"},null,512),[[v,e.valiCode]]),p("img",{onClick:a[21]||(a[21]=a=>e.changeValiCode()),src:e.img,alt:"Captcha",class:"captcha-image"},null,8,Se)])]),p("div",Ne,[p("button",{onClick:a[22]||(a[22]=a=>e.register()),class:"btn btn-primary"},"注册提交"),p("button",{onClick:a[23]||(a[23]=a=>e.backLogin()),class:"btn btn-secondary"},"返回登录")])])):y("",!0)]))])),_:1})])]),a[42]||(a[42]=p("footer",{class:"footer"},[p("p",{class:"footer-text"},"Copyright © 山东大学软件学院")],-1))])}],["__scopeId","data-v-32d95ee3"]]);export{Fe as default};
