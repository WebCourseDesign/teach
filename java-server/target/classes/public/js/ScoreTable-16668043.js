import{d as e,u as t,M as l,_ as a,c as s,e as d,f as i,w as o,F as u,z as r,N as m,G as n,V as c,o as p,j as h,y as f,O as I,x as b,E as _,m as y,P as k,I as v,J as V,D as g}from"./index-ebbc268c.js";/* empty css                *//* empty css              *//* empty css                     *//* empty css                 *//* empty css                     *//* empty css            *//* empty css                  *//* empty css               *//* empty css               */import{d as w,e as j,f as L,h as C,s as q,i as x}from"./teachingServ-68e3f6d8.js";import{m as N,a as U}from"./messageBox-dafa18e6.js";import{l as E}from"./lodash-f2b20e9b.js";import"./request-c45980cc.js";const B=e({data:()=>({scoreList:[],studentId:null,courseId:null,editedItem:{},studentList:[],courseList:[],deleteId:-1,dialogVisible:!1}),computed:{},created(){this.initialize()},methods:{async initialize(){this.scoreList=await w(this.studentId,this.courseId),this.studentList=await j(),this.courseList=await L();if("ROLE_TEACHER"==t().userInfo.roles){const e=await C();this.courseList=e}},async refresh(){await this.query()},async query(){this.scoreList=await w(this.studentId,this.courseId)},checkMark(){return!(this.editedItem.mark<0||this.editedItem.mark>100)},addItem(){this.editedItem={},this.dialogVisible=!0},editItem(e){this.editedItem=E.cloneDeep(e),this.dialogVisible=!0},close(){this.dialogVisible=!1},async confirm(){if(this.close(),null==this.editedItem.studentId||null==this.editedItem.courseId)return void l.alert("学生和课程不能为空");if(!this.editedItem.mark||isNaN(this.editedItem.mark)||this.editedItem.mark<0||this.editedItem.mark>100)return void l.alert("成绩数据非法");const e=await q(this.editedItem.scoreId,this.editedItem.studentId,this.editedItem.courseId,this.editedItem.mark);0==e.code?(N(this,"保存成功"),this.query()):l.alert(e.msg),this.refresh()},async deleteItem(e){if(!(await U("确认删除吗?")))return;const t=await x(e);0==t.code?(N(this,"删除成功"),this.query()):N(this,t.msg)}}}),M={class:"base_form"},z={class:"base_query_oneLine"},D={class:"query_left"},A={class:"query_right"},G={class:"table_center",style:{"margin-top":"5px"}},H={style:{display:"flex","justify-content":"center","margin-top":"10px"}};const J=a(B,[["render",function(e,t,l,a,w,j){const L=r,C=_,q=y,x=k,N=m,U=v,E=V,B=n,J=g,O=c;return p(),s(u,null,[d("div",M,[t[12]||(t[12]=d("div",{class:"base_header"},[d("div",{class:"blue_column"}),d("div",{class:"base_title"},"成绩管理")],-1)),d("div",z,[d("div",D,[i(L,{class:"commButton",type:"primary",onClick:t[0]||(t[0]=t=>e.addItem())},{default:o((()=>t[8]||(t[8]=[h("添加")]))),_:1})]),d("div",A,[i(N,{inline:!0},{default:o((()=>[i(x,{label:"学生"},{default:o((()=>[i(q,{modelValue:e.studentId,"onUpdate:modelValue":t[1]||(t[1]=t=>e.studentId=t)},{default:o((()=>[(p(!0),s(u,null,f(e.studentList,(e=>(p(),I(C,{label:e.title,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(x,{label:"课程"},{default:o((()=>[i(q,{modelValue:e.courseId,"onUpdate:modelValue":t[2]||(t[2]=t=>e.courseId=t)},{default:o((()=>[(p(!0),s(u,null,f(e.courseList,(e=>(p(),I(C,{label:e.title,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(x,null,{default:o((()=>[i(L,{type:"default",class:"commButton",onClick:t[3]||(t[3]=t=>e.query())},{default:o((()=>t[9]||(t[9]=[h("查询")]))),_:1})])),_:1})])),_:1})])]),d("div",G,[i(B,{data:e.scoreList},{default:o((()=>[i(U,{label:"学号",prop:"studentNum"}),i(U,{label:"姓名",prop:"studentName"}),i(U,{label:"班级",prop:"className"}),i(U,{label:"课程号",prop:"courseNum"}),i(U,{label:"课程名",prop:"courseName"}),i(U,{label:"学分",prop:"credit"}),i(U,{label:"成绩"},{default:o((e=>[h(b("null"==e.row.mark?"未打分":e.row.mark),1)])),_:1}),i(U,{label:"操作"},{default:o((l=>[i(E,null,{default:o((()=>[i(L,{onClick:t=>e.editItem(l.row),type:"success"},{default:o((()=>t[10]||(t[10]=[h("编辑")]))),_:2},1032,["onClick"]),i(L,{onClick:t=>e.deleteItem(l.row.scoreId),type:"danger"},{default:o((()=>t[11]||(t[11]=[h("删除")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])]),i(O,{id:"favDialog",modelValue:e.dialogVisible,"onUpdate:modelValue":t[7]||(t[7]=t=>e.dialogVisible=t),"before-close":e.handleClose,width:"400px"},{header:o((()=>t[13]||(t[13]=[d("h1",null,"成绩添加修改对话框",-1)]))),default:o((()=>[i(N,{"label-width":"80px",model:e.editedItem,ref:"form"},{default:o((()=>[i(x,{label:"学生"},{default:o((()=>[i(q,{modelValue:e.editedItem.studentId,"onUpdate:modelValue":t[4]||(t[4]=t=>e.editedItem.studentId=t),placeholder:"请选择..."},{default:o((()=>[(p(!0),s(u,null,f(e.studentList,(e=>(p(),I(C,{label:e.title,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),i(x,{label:"课程名"},{default:o((()=>[i(q,{modelValue:e.editedItem.courseId,"onUpdate:modelValue":t[5]||(t[5]=t=>e.editedItem.courseId=t),placeholder:"请选择..."},{default:o((()=>[(p(!0),s(u,null,f(e.courseList,(e=>(p(),I(C,{label:e.title,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),i(x,{label:"成绩",prop:"mark",rules:[{required:!0,message:"成绩从0-100",trigger:"blur",validator:e.checkMark}]},{default:o((()=>[i(J,{modelValue:e.editedItem.mark,"onUpdate:modelValue":t[6]||(t[6]=t=>e.editedItem.mark=t),modelModifiers:{number:!0},style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["model"]),d("div",H,[i(L,{type:"primary",onClick:e.confirm},{default:o((()=>t[14]||(t[14]=[h("确认")]))),_:1},8,["onClick"]),i(L,{onClick:e.close},{default:o((()=>t[15]||(t[15]=[h("取消")]))),_:1},8,["onClick"])])])),_:1},8,["modelValue","before-close"])],64)}]]);export{J as default};
