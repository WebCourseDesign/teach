import{d as t,A as e,B as i,C as s,D as a,F as l,_ as n,c as d,f as r,G as o,H as c,I as u,e as h,w as m,x as p,J as f,o as g,k as L}from"./index-be5cb234.js";/* empty css                 */import{e as x}from"./index-d3cb131f.js";import{m as y}from"./messageBox-168aaa44.js";import{e as w}from"./studentServ-6987dbcf.js";import"./request-9dd860e1.js";const v=x,I=t({data:()=>({authHeader:e(),valid:!1,uploadIsLoading:!1,studentId:null,imgStr:"",info:{},feeList:[],markList:[],scoreList:[],nameRules:[],emailRules:[],echartBar:null,echartLine:null,echartPie:null,gpa:0}),async created(){let t=await i(this.studentId);this.info=t.data.info,this.studentId=this.info.studentId,this.feeList=t.data.feeList,this.markList=t.data.markList,this.scoreList=t.data.scoreList;let e=0,a=0;for(let i=0;i<this.scoreList.length;i++){if(null==this.scoreList[i].mark)continue;e+=((this.scoreList[i].mark-50)/10>0?(this.scoreList[i].mark-50)/10:0)*this.scoreList[i].credit}for(let i=0;i<this.scoreList.length;i++)null!=this.scoreList[i].mark&&(a+=this.scoreList[i].credit);this.gpa=Math.ceil(e/a*100)/100,t=await s(this.info.personId+".jpg"),this.imgStr=t.data,this.drawEcharts()},mounted(){},methods:{drawEcharts(){this.echartBar=v.init(document.getElementById("myChartBar")),this.echartBar.setOption({title:{text:"日常消费"},tooltip:{},xAxis:{data:this.feeList.map((t=>t.title))},yAxis:{},series:[{name:"消费",type:"bar",data:this.feeList.map((t=>t.value))}]}),this.echartLine=v.init(document.getElementById("myChartLine")),this.echartLine.setOption({title:{text:"日常消费"},tooltip:{},xAxis:{data:this.feeList.map((t=>t.title))},yAxis:{},series:[{name:"消费",type:"line",data:this.feeList.map((t=>t.value))}]}),this.echartPie=v.init(document.getElementById("myChartPie")),this.echartPie.setOption({title:{text:"成绩分布"},tooltip:{},legend:{orient:"horizontal",x:"center",y:"bottom",data:this.markList.map((t=>t.title))},series:[{type:"pie",data:this.markList}]})},async uploadFile(){const t=document.querySelector("#file");if(null==t.files||0==t.files.length)return void y(this,"请选择文件！");if(0===(await a(this.info.personId+".jpg",t.files[0])).code){y(this,"上传成功");let t=await s(this.info.personId+".jpg");this.imgStr=t.data}else y(this,"上传失败")},downloadPdf(){l("/api/student/getStudentIntroduceItextPdf",this.info.num+".pdf",{studentId:this.studentId,barBase64:this.echartBar.getDataURL(),lineBase64:this.echartLine.getDataURL(),pieBase64:this.echartPie.getDataURL()});this.echartBar.getDataURL()},onSuccess(t){0==t.code?y(this,"上传成功！"):y(this,t.msg)},exportPersonIntro(){w().then((t=>{this.download(this.info.num+".pdf",t.data)}))},download(t,e){const i=new Blob([e]),s=document.createElement("a");s.href=window.URL.createObjectURL(i),s.download=t,document.body.appendChild(s),s.click(),document.removeChild(s),window.URL.revokeObjectURL(s)}}}),b={class:"base_form"},k={class:"table_center",style:{"margin-top":"5px"}},B={class:"content"},j={rowspan:"3"},_=["src"],C={colspan:"3"},P={class:"table_center",style:{"margin-top":"5px"}},R={style:{color:"#930e14","font-weight":"bold","text-align":"center"}},S={class:"content"};const U=n(I,[["render",function(t,e,i,s,a,l){const n=p,x=f;return g(),d(c,null,[r("div",b,[e[16]||(e[16]=r("div",{class:"base_header"},[r("div",{class:"blue_column"}),r("div",{class:"base_title"},"个人画像")],-1)),r("div",k,[r("table",B,[r("tr",null,[e[3]||(e[3]=r("td",null,"学号",-1)),r("td",null,o(t.info.num),1),e[4]||(e[4]=r("td",null,"姓名",-1)),r("td",null,o(t.info.name),1),e[5]||(e[5]=r("td",null,"学院",-1)),r("td",null,o(t.info.dept),1),r("td",j,[r("img",{src:t.imgStr,alt:"个人照片",width:"200"},null,8,_)])]),r("tr",null,[e[6]||(e[6]=r("td",null,"专业",-1)),r("td",null,o(t.info.major),1),e[7]||(e[7]=r("td",null,"班级",-1)),r("td",null,o(t.info.className),1),e[8]||(e[8]=r("td",null,"证件号码",-1)),r("td",null,o(t.info.card),1)]),r("tr",null,[e[9]||(e[9]=r("td",null,"性别",-1)),r("td",null,o(t.info.genderName),1),e[10]||(e[10]=r("td",null,"出生日期",-1)),r("td",null,o(t.info.birthday),1),e[11]||(e[11]=r("td",null,"邮箱",-1)),r("td",null,o(t.info.email),1)]),r("tr",null,[e[13]||(e[13]=r("td",null,"电话",-1)),r("td",null,o(t.info.phone),1),e[14]||(e[14]=r("td",null,"地址",-1)),r("td",C,o(t.info.address),1),r("td",null,[e[12]||(e[12]=r("input",{style:{"margin-left":"10px"},type:"file",id:"file",accept:"image/jpeg"},null,-1)),r("input",{type:"button",value:"图片上传",onClick:e[0]||(e[0]=e=>t.uploadFile())})])])])]),r("div",P,[r("div",R," 您本学期目前GPA为："+o(t.gpa),1),r("table",S,[e[15]||(e[15]=r("tr",null,[r("td",{width:"5%"},"课程号"),r("td",{width:"5%"},"课程名"),r("td",{width:"5%"},"学分"),r("td",{width:"5%"},"成绩"),r("td",{width:"5%"},"排名")],-1)),(g(!0),d(c,null,u(t.scoreList,(t=>(g(),d("tr",{key:t.studentId},[r("td",null,o(t.courseNum),1),r("td",null,o(t.courseName),1),r("td",null,o(t.credit),1),r("td",null,o(t.mark),1),r("td",null,o(t.ranking),1)])))),128))])]),e[17]||(e[17]=r("div",{class:"chart-container"},[r("div",{id:"myChartBar",style:{width:"300px",height:"350px"}}),r("div",{id:"myChartPie",style:{width:"300px",height:"350px"}}),r("div",{id:"myChartLine",style:{width:"300px",height:"350px"}})],-1))]),r("div",null,[h(x,{style:{display:"inline-block","margin-left":"5px"},headers:t.authHeader,action:"/api/student/importFeeDataWeb",data:{studentId:t.studentId},accept:".xlsx,.xls","show-file-list":!0,limit:1,multiple:!1,"on-success":t.onSuccess},{default:m((()=>[h(n,{class:"spacial"},{default:m((()=>e[18]||(e[18]=[L("消费记录上传")]))),_:1})])),_:1},8,["headers","data","on-success"]),h(n,{style:{"margin-left":"5px"},class:"spacial",onClick:e[1]||(e[1]=e=>t.downloadPdf())},{default:m((()=>e[19]||(e[19]=[L("个人画像下载")]))),_:1}),h(n,{style:{"margin-left":"5px"},class:"spacial",onClick:e[2]||(e[2]=e=>t.exportPersonIntro())},{default:m((()=>e[20]||(e[20]=[L("个人简历下载")]))),_:1})])],64)}],["__scopeId","data-v-4f626d9e"]]);export{U as default};
